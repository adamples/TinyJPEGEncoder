#include <stdio.h>
#include "tiny_jpeg.h"

#define IMAGE_WIDTH 16
#define IMAGE_HEIGHT 8


unsigned char image[256] = {
  52, 0, 55, 0, 61, 0, 66, 0, 70, 0, 61, 0, 64, 0, 73, 0,
  52, 0, 55, 0, 61, 0, 66, 0, 70, 0, 61, 0, 64, 0, 73, 0,
  63, 0, 59, 0, 55, 0, 90, 0, 109, 0, 85, 0, 69, 0, 72, 0,
  63, 0, 59, 0, 55, 0, 90, 0, 109, 0, 85, 0, 69, 0, 72, 0,
  62, 0, 59, 0, 68, 0, 113, 0, 144, 0, 104, 0, 66, 0, 73, 0,
  62, 0, 59, 0, 68, 0, 113, 0, 144, 0, 104, 0, 66, 0, 73, 0,
  63, 0, 58, 0, 71, 0, 122, 0, 154, 0, 106, 0, 70, 0, 69, 0,
  63, 0, 58, 0, 71, 0, 122, 0, 154, 0, 106, 0, 70, 0, 69, 0,
  67, 0, 61, 0, 68, 0, 104, 0, 126, 0, 88, 0, 68, 0, 70, 0,
  67, 0, 61, 0, 68, 0, 104, 0, 126, 0, 88, 0, 68, 0, 70, 0,
  79, 0, 65, 0, 60, 0, 70, 0, 77, 0, 68, 0, 58, 0, 75, 0,
  79, 0, 65, 0, 60, 0, 70, 0, 77, 0, 68, 0, 58, 0, 75, 0,
  85, 0, 71, 0, 64, 0, 59, 0, 55, 0, 61, 0, 65, 0, 83, 0,
  85, 0, 71, 0, 64, 0, 59, 0, 55, 0, 61, 0, 65, 0, 83, 0,
  87, 0, 79, 0, 69, 0, 68, 0, 65, 0, 76, 0, 78, 0, 94, 0,
  87, 0, 79, 0, 69, 0, 68, 0, 65, 0, 76, 0, 78, 0, 94, 0
};


int main(void)
{
  jpeg_proc_t   processor;
  uint8_t       buffer[512];
  int           bytes;
  int           sum = 0;

  tjpeg_feed_data(&processor, IMAGE_WIDTH, IMAGE_HEIGHT, image);
  bytes = tjpeg_write(&processor, buffer, 16);
  sum += bytes;
  printf("Output size: %d.\n", bytes);
  bytes = tjpeg_write(&processor, buffer + bytes, 16);
  sum += bytes;
  printf("Output size: %d.\n", bytes);
}
